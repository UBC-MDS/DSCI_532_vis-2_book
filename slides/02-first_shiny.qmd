---
title: "Your first Shiny application"
---

## Plan out your application data

- Start off with the data you have an some kind of data artifact without the interactivity
- Use a placeholder variable to apply the interactivity manually

## Visualizing penguin data

<!--TODO: #| output-location: slide is broken -->

```{python}
#| echo: true

{{< include /code/lecture01/01-vis-altair.py >}}
```

## Change the species

<!-- TODO: #| output-location: slide is broken -->

```{python}
#| echo: true

{{< include /code/lecture01/02-vis-altair-change_species.py >}}
```

## Your Turn

- Create the working baseline code:

{{< countdown "2:00">}}

```{python}
#| output: false

{{< include /code/lecture01/02-vis-altair-change_species.py >}}
```

## The user interface

- Best try to mock up or wireframe a UI before starting
- Input Components Gallery: <https://shiny.posit.co/py/components/#inputs>

- What might be a good component to use?

{{< countdown "1:00">}}

## Radio Buttons

```{shinylive-python}
#| standalone: true
#| components: [editor, viewer]
#| layout: horizontal

{{< include /code/lecture01/app-01-core-radio.py >}}
```

## Run your application

1. Positron/VS Code + Shiny Extension

![](/img/positron-run.png){width="300px" fig-align="center"}

:::{.callout-tip}
Begin your application file names with `app-*` so you can use the play button.
:::

2. Command line:

```bash
shiny run --reload app.py
```



## Radio Buttons: options

<https://shiny.posit.co/py/api/core/ui.input_radio_buttons.html>

```{shinylive-python}
#| standalone: true
#| components: [editor, viewer]
#| layout: horizontal

{{< include /code/lecture01/app-02-core-radio-options.py >}}

```

{{< countdown "2:00">}}

## Add in the figure

Now let's add all that data and plotting code from earlier into our application.

If we just dump in our code,
the application errors because it does not know what to do with the figure that's trying to be printed.

## Output will error

```{shinylive-python}
#| standalone: true
#| components: [editor, viewer]
#| layout: horizontal

{{< include /code/lecture01/app-03-core-altair-error.py >}}
```

## Outputs (python core syntax + R)

- Each output component has 2 parts:
    - `ui.output_*` call in the UI part of the application
    - each output needs to be wrapped in it's own function with the corresponding output decorator.
<https://shiny.posit.co/py/components/#outputs>

- We now need to use one of the built-in
[Shiny output components](https://shiny.posit.co/py/components/#outputs),

- `plotnine` figure (which is based on `matplotlib`),
[plot output component](https://shiny.posit.co/py/components/outputs/plot-matplotlib/).

- For example, we want to return a plot, so we will need to wrap our plotnine code,
and decorate it with the `@render.plot` decorator.

- For altair (and jupyter widgets) we need to use the `shinywidgets` package

## Render plot output

```{.python}
...
from shinywidgets import render_altair, output_widget
...

app_ui = ui.page_fluid(
    ...

    output_widget("plot"),


def server(input, output, session):
    @render_altair
    def plot():
        dat = load_penguins().dropna()
        ...
```

::: {.callout-important}
## Return the output

Donâ€™t forget to return the object you want displayed in the function! Otherwise the output will not render.
:::

## Render plot output

```{shinylive-python}
#| standalone: true
#| components: [editor, viewer]
#| layout: horizontal

{{< include /code/lecture01/app-04-core-altair-output.py >}}
```

## Reactivity

- But the radio buttons don't change anything
- We didn't connect the input component to the output component

- [Reactivity](https://shiny.posit.co/py/docs/reactive-foundations.html) is what makes Shiny unique
    - More about reactivity next lecture
    - tl;dr: use `input.ID()` to read the input component value

## The data reacts to the input

```{.python}
...
    ui.input_radio_buttons(
        id="species",
        label="Species",
        choices=["Adelie", "Gentoo", "Chinstrap"],
        inline=True,
    ),
...

        species = input.species()
...
```

## Your first application: altair

```{shinylive-python}
#| standalone: true
#| components: [editor, viewer]
#| layout: horizontal
#| viewerHeight: 500

{{< include /code/lecture01/app-05-core-altair-first_app.py >}}
```
